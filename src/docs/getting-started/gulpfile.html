
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>Document</title>
 <!-- 引入head -->
 {{include '../../../base/public/header'}}
</head>
<body>
 <!-- side bar -->
 <div>
 <ul> <li><a href="message.html">提示消息 message</a></li> <li><a href="pagination.html">分页 pagination</a></li> <li><a href="message.html">消息 message</a></li> <li><a href="tooltip.html">提示 tooltip</a></li> <li><a href="breadcrumb.html">面包屑 breadcrumb</a></li> <li><a href="panel.html">面板 panel</a></li> <li><a href="dropdown.html">下拉 dropdown</a></li> <li><a href="buttongroup.html">按钮组 buttongroup</a></li> <li><a href="inputgroup.html">输入框组 inputgroup</a></li> <li><a href="navbar.html">导航条 navbar</a></li> <li><a href="thumbnail.html">缩略图 thumbnail</a></li> <li><a href="media.html">媒体对象 meida</a></li> <li><a href="listgroup.html">列表组 listgroup</a></li> <li><a href="gallery.html">图片画廊 gallery</a></li> <li><a href="statisticWidget.html">卡片</a></li> </ul>
 </div>

 <!-- content -->
 <div>
 

<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>Document</title>
 <!-- 引入head -->
 {{include '../../../base/public/header'}}
</head>
<body>
 <!-- side bar -->
 <div>
 <ul> <li><a href="message.html">提示消息 message</a></li> <li><a href="pagination.html">分页 pagination</a></li> <li><a href="message.html">消息 message</a></li> <li><a href="tooltip.html">提示 tooltip</a></li> <li><a href="breadcrumb.html">面包屑 breadcrumb</a></li> <li><a href="panel.html">面板 panel</a></li> <li><a href="dropdown.html">下拉 dropdown</a></li> <li><a href="buttongroup.html">按钮组 buttongroup</a></li> <li><a href="inputgroup.html">输入框组 inputgroup</a></li> <li><a href="navbar.html">导航条 navbar</a></li> <li><a href="thumbnail.html">缩略图 thumbnail</a></li> <li><a href="media.html">媒体对象 meida</a></li> <li><a href="listgroup.html">列表组 listgroup</a></li> <li><a href="gallery.html">图片画廊 gallery</a></li> <li><a href="statisticWidget.html">卡片</a></li> </ul>
 </div>

 <!-- content -->
 <div>
 
<p>var gulp = require(&#39;gulp&#39;);
var del = require(&#39;del&#39;);
var fs = require( &#39;fs&#39; );
var stat = fs.stat;
var template = require( &#39;art-template&#39; );
var zip = require(&#39;gulp-zip&#39;);
var flatmap = require(&#39;gulp-flatmap&#39;);
var git = require(&#39;gulp-git&#39;);
var webpack = require(&#39;gulp-webpack&#39;);
var path = require(&#39;path&#39;);</p>
<p>var fileDir = fs.readdirSync(&#39;./&#39;);
var uuiDir = fileDir.indexOf(&#39;generate-uui&#39;);</p>
<p>/**</p>
<ul>
<li>编译导出</li>
<li>@param {[type]} src [编译路径]</li>
<li>@return {[type]} [description]
*/
var compile = function( src ){
 // 同步加载
 var paths = fs.readdirSync(src);
 paths.forEach(function( path ){<pre><code> var _src = src + &#39;/&#39; + path; 
 stat( _src, function( err, st ){
 if( err ){
 throw err;
 }
 // 判断是否为文件
 if( st.isFile() ){
 // 编译
 if ( /\.html$/.test(_src) ) {
 var filePath = _src.replace(/\.html$/g, &#39;&#39;);
 var dataPath = filePath.replace(/\/pages\//,&#39;/data/&#39;);
 var isexist = fs.existsSync(dataPath + &#39;.json&#39;);
 // var data = require(dataPath + &#39;.json&#39;);
 if(filePath === &#39;./dist/index&#39;) {
 var data = require(&#39;./src/data/index.json&#39;);
 var html = template(filePath, data);
 return fs.writeFileSync( filePath + &#39;.html&#39;, html); 
 }
 if (isexist){
 var data = require(dataPath + &#39;.json&#39;);
 var html = template( filePath, data);
 fs.writeFileSync( filePath + &#39;.html&#39;, html); 
 }
 }
 } else if(st.isDirectory()){
 compile(_src);
 }
 });
</code></pre> });
};
gulp.task(&#39;copy&#39;, function() {
 return gulp.src([&#39;./src/**&#39;])<pre><code> .pipe(gulp.dest(&#39;./dist&#39;)); 
</code></pre>});
gulp.task(&#39;common&#39;, [&#39;copy&#39;], function() {
 return gulp.src([&#39;./src/common/**&#39;])<pre><code> .pipe(gulp.dest(&#39;./dist/pages/common&#39;));
</code></pre>});
gulp.task(&#39;compile&#39;, [&#39;common&#39;], function() {
 return compile(&#39;./dist&#39;);
});
gulp.task(&#39;del&#39;, [&#39;compile&#39;], function() {
 del([&#39;./dist/public&#39;, &#39;./dist/data&#39;,&#39;./dist/common&#39;]);
});</li>
</ul>
<p>/**</p>
<ul>
<li>压缩模板</li>
<li>@param {[type]} ) {} [description]</li>
<li>@return {[type]} [description]
<em>/
// gulp.task(&#39;zip&#39;, function() {
// return gulp.src(&#39;./dist/website/</em>&#39;)
// .pipe(flatmap(function(stream, file){
// var fileName = file.path.substr(file.path.lastIndexOf(&#39;/&#39;) + 1);
// gulp.src(file.path + &#39;/<em>*/</em>&#39;)
// .pipe(zip(fileName+&#39;.zip&#39;))
// .pipe(gulp.dest(&#39;./dist/download&#39;));
// return stream;
// }));
// });</li>
</ul>
<p>/**</p>
<ul>
<li>更新仓库</li>
<li><p>@return {[type]} [description]
*/
function pullFun(){</p>
<p> git.pull(&#39;origin&#39;, &#39;master&#39;,function(){</p>
<pre><code> console.log(&#39;仓库pull完毕&#39;);
 zipFun(); 
</code></pre><p> });
}</p>
</li>
</ul>
<p>/**</p>
<ul>
<li>压缩框架内容</li>
<li>@return {[type]} [description]
*/</li>
</ul>
<p>function zipFun(){
 var version = require(&#39;./generate-uui/package.json&#39;).version;
 console.log(&#39;版本号:&#39; + version);
 return gulp.src(&#39;./generate-uui/dist/uui/&#39; + version + &#39;/<strong>&#39;)
 .pipe(gulp.dest(&#39;./dist/website/iuapdesign&#39;))
 .on(&#39;end&#39;, function() {
 return gulp.src(&#39;./dist/website/iuapdesign/</strong>&#39;)
 .pipe(zip(&#39;iuapdesign.zip&#39;))
 .pipe(gulp.dest(&#39;./dist/download&#39;));
 });<br>}</p>
<p>/**</p>
<ul>
<li>clone/pull仓库并生成首页框架下载资源</li>
<li>@param {[type]} ) { var fileDir [description]</li>
<li>@return {[type]} [description]
*/
gulp.task(&#39;clone&#39;, function() {
 if(uuiDir === -1) {<pre><code> git.clone(&#39;git@github.com:iuap-design/generate-uui.git&#39;, function(err){
 if (err) {
 throw err;
 } else {
 console.log(&#39;Clone仓库完毕&#39;);
 zipFun();
 }
 }); 
</code></pre> } else {<pre><code> pullFun();
</code></pre> }
});</li>
</ul>
<p>gulp.task(&#39;watcher&#39;, function() {
 gulp.watch(&#39;./src/<em>*/</em>.html&#39;,[&#39;del&#39;]);
});</p>
<p>gulp.task(&#39;newpack&#39;, [&#39;clone&#39;]);
gulp.task(&#39;default&#39;, [&#39;del&#39;]);</p>
<p>/**</p>
<ul>
<li>此部分作为测试webpack
*/
gulp.task(&#39;webpack&#39;, function() {
 return gulp.src(path.resolve(__dirname, &#39;./entry.js&#39;))<pre><code> .pipe(webpack({
 module:{
 loaders:[
 {
 test: /(\.jsx|\.js)$/,
 loader: &#39;babel&#39;,
 exclude: /(bower_components)/ 
 }
 ] 
 },
 output:{
 filename:&#39;u.js&#39;,
 libraryTarget:&#39;umd&#39;,
 umdNamedDefine: true
 },
 resolve:{
 extensions: [&#39;&#39;,&#39;.js&#39;,&#39;.jsx&#39;]
 }
 }))
 .pipe(gulp.dest(path.resolve(__dirname,&#39;./download&#39;)));
</code></pre>});</li>
</ul>
 </div>

 <!-- 引入end -->
 {{include '../../../base/public/footer'}}
</body>
</html>
 </div>

 <!-- 引入end -->
 {{include '../../../base/public/footer'}}
</body>
</html>
